"use strict";(globalThis.webpackChunk_openmrs_esm_offline_tools_app=globalThis.webpackChunk_openmrs_esm_offline_tools_app||[]).push([[316],{524:(n,t,e)=>{e.d(t,{_$:()=>m,jH:()=>p,jJ:()=>v,mi:()=>h});var r=e(4610),i=e(752),o=e(5776),a=e(4572);function u(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function c(n,t,e,r,i,o,a){try{var u=n[o](a),c=u.value}catch(n){return void e(n)}u.done?t(c):Promise.resolve(c).then(r,i)}function f(n){return function(){var t=this,e=arguments;return new Promise((function(r,i){var o=n.apply(t,e);function a(n){c(o,r,i,a,u,"next",n)}function u(n){c(o,r,i,a,u,"throw",n)}a(void 0)}))}}function l(n){return function(n){if(Array.isArray(n))return u(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,t){if(n){if("string"==typeof n)return u(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?u(n,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(n){return(0,a.ZP)("dynamicOfflineData/entries/".concat(n),(function(){return(0,r.getDynamicOfflineDataEntries)(n)}))}function d(n){return(0,a.ZP)("syncQueue/items/".concat(n),(function(){return(0,r.getSynchronizationItems)(n)}))}function p(){var n=s("patient"),t=d("patient-registration");return y((function(){return t.data.filter((function(t){return t.fhirPatient&&!n.data.find((function(n){return n.identifier===t.fhirPatient.id}))})).map((function(n){return n.fhirPatient}))}),[n,t])}function m(){var n,t,e,u,c=s("patient"),f=d("patient-registration"),p=(e=null!==(t=null===(n=c.data)||void 0===n?void 0:n.map((function(n){return n.identifier})))&&void 0!==t?t:[],u=(0,o.useMemo)((function(){return l(e).sort()}),[e]),(0,a.ZP)(["fhirPatients",u],(function(){return Promise.all(u.map((function(n){return(0,r.fetchCurrentPatient)(n,void 0,!1)})))})));return y((function(){return c.data.map((function(n){var t=p.data.find((function(t){return t.id===n.identifier})),e=f.data.filter((function(t){return t.fhirPatient.id===n.identifier})).map((function(n){return n.fhirPatient}));return{patient:i.Z.apply(void 0,[t].concat(l(e))),entry:n}}))}),[c,f,p])}function h(){var n=s("patient"),t=p();return y((function(){return{downloadedCount:n.data.length,registeredCount:t.data.length}}),[n,t])}function v(n){return(0,a.ZP)("offlineTools/offlinePatient/".concat(n,"/lastSyncState"),f((function(){var t,e;return function(n,t){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(n,a)}catch(n){o=[6,n],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}(this,(function(i){switch(i.label){case 0:return[4,(0,r.getDynamicOfflineDataEntries)("patient")];case 1:return t=i.sent(),[2,null==(e=t.find((function(t){return t.identifier===n})))?void 0:e.syncState]}}))})))}function y(n,t){return(0,o.useMemo)((function(){return{data:t.every((function(n){return!!n.data}))?n():null,error:t.find((function(n){return n.error})),mutate:function(){return Promise.all(t.map((function(n){return n.mutate()}))).then(n)},isValidating:t.some((function(n){return n.isValidating})),isLoading:t.some((function(n){return n.isLoading}))}}),[n].concat(l(t.flatMap((function(n){return[n.data,n.error,n.isValidating]})))))}},7316:(n,t,e)=>{e.r(t),e.d(t,{default:()=>l});var r=e(5776),i=e.n(r),o=e(2680),a=e(1681),u=e(1180),c=e(1217),f=e(524);const l=function(){var n=(0,o.useTranslation)().t,t=(0,f.mi)().data;return i().createElement(u.Z,{header:n("homeOverviewCardPatientsHeader","Patients"),viewLink:c._.offlineToolsPatients},i().createElement(a.Z,{header:n("homeOverviewCardPatientsDownloaded","Downloaded"),content:null==t?void 0:t.downloadedCount,isLoading:!t}),i().createElement(a.Z,{header:n("homeOverviewCardPatientsNewlyRegistered","Newly registered"),content:null==t?void 0:t.registeredCount,isLoading:!t}))}}}]);